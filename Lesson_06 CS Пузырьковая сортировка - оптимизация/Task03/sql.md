# Вопросы на знание SQL
##	1. Объясните разницу между командами DELETE и TRUNCATE, условиями WHERE и HAVING.

    DELETE vs TRUNCATE
        
**DELETE** удаляет одну или несколько строк из таблицы или представления, при этом эта операция всегда полностью регистрируется в журнале транзакций, т.е. каждая удаленная строка.

**TRUNCATE TABLE** удаляет все строки в таблице, не записывая в журнал транзакций удаление отдельных строк данных. TRUNCATE TABLE похожа на инструкцию DELETE без предложения WHERE, но она выполняется быстрее и требует меньше ресурсов.

Иными словами TRUNCATE TABLE удаляет все записи из таблицы, в том числе нумерацию первичного ключа, когда как после DELETE нумерация первичного ключа сохраняется.



    WHERE vs HAVING

В **HAVING** и только в нём можно писать условия по агрегатным функциям (SUM, COUNT, MAX, MIN и т. д.). Например, сделать что-то вроде COUNT(*) > 10 возможно только с помощью **HAVING**. 

**WHERE** выполняется до формирования групп **GROUP BY**. Это нужно для того, чтобы можно было оперировать как можно меньшим количеством данных и сэкономить ресурсы сервера и время пользователя. 

Следующим этапом формируются группы, которые указаны в **GROUP BY**. После того как сформированы группы, можно накладывать условия на результаты агрегатных функций с помощью **HAVING**. 

Главное отличие **HAVING** от **WHERE** в том, что в **HAVING** можно наложить условия на результаты группировки, потому что порядок исполнения запроса устроен таким образом, что на этапе, когда выполняется **WHERE**, ещё нет групп, а **HAVING** выполняется уже после формирования групп. 



## 2.	В чем разница между функциями isnull() / coalesce()? 

    COALENCE vs ISNULL

**COALESCE** возвращает первое выражение из списка параметров, неравное NULL.

**ISNULL** заменяет значение NULL первого параметра, на указанное значение во втором параметре. Другими словами, в случае если первый параметр равен NULL, то возвращается второй параметр.

## 3.	Для чего используются регулярные выражения?

**Регулярное выражение** — последовательность букв и/или символов, которая может встречаться в слове. Использование регулярных выражений может помочь легко и просто решить достаточно трудные задачи по поиску определенных шаблонов в тексте. 

## 4.	Приведите пример использования оконной функции.

**Оконная функция** в SQL - функция, которая работает с выделенным набором строк (окном, партицией) и выполняет вычисление для этого набора строк в отдельном столбце. 

**Партиции** (окна из набора строк) - это набор строк, указанный для оконной функции по одному из столбцов или группе столбцов таблицы. Партиции для каждой оконной функции в запросе могут быть разделены по различным колонкам таблицы.


## 5.	Как найти дубли в полях таблицы?

Подсчет всех записей с одинаковыми значениями в поле 'col1':

    SELECT
        `col1`,
        COUNT(`col1`) AS `count`
    FROM
        `table`
    GROUP BY
        `col1`
    HAVING 
        `count` > 1
Подсчет дубликатов по нескольким полям:

    SELECT
        `col1`,
        `col2`,
        COUNT(*) AS `count`
    FROM
        `table`
    GROUP BY
        `col1`,`col2`
    HAVING 
        `count` > 1

Запрос получит только дубликаты, в результат не попадают записи с самым ранним `id`.

    SELECT 
        `table`.*
    FROM
        `table`
    LEFT OUTER JOIN 
        (SELECT MIN(`id`) AS `id`, `col1` FROM `table` GROUP BY `col1`) AS `tmp` 
    ON 
        `table`.`id` = `tmp`.`id`  
    WHERE
        `tmp`.`id` IS NULL


## 6.	Как для ряда [2, -2, 4, -4, -3, 0, 2, 3, 5] рассчитать суммы всех отрицательных чисел и сумму нечетных чисел одним запросом?

Вывод суммы положительных и отрицательных значений:

    select adate, 
        sum(case when val > 0 then val else 0 end) psum,
        sum(case when val < 0 then val else 0 end) msum,
    from mytable group by adate

7.	Как получить последний id (автоинкремент) без использования функции max?
8.	Что выведет приведенный запрос, если в таблице Employees 10 записей?
BEGIN TRAN
TRUNCATE TABLE Employees
ROLLBACK
SELECT * FROM Employees
9.	Важен ли в составном индексе порядок столбцов?
10.	Что такое план запросов и на какие характеристики необходимо обращать внимание?
